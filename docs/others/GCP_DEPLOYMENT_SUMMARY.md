# GCPéƒ¨ç½²æ–‡ä»¶æ€»ç»“

æœ¬æ–‡æ¡£æ€»ç»“äº†ä¸ºGCPéƒ¨ç½²åˆ›å»ºçš„æ‰€æœ‰æ–‡ä»¶å’Œé…ç½®ã€‚

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶åˆ—è¡¨

### æ–‡æ¡£æ–‡ä»¶

1. **docs/gcp_deployment_guide.md**
   - å®Œæ•´çš„GCPéƒ¨ç½²æŒ‡å—
   - åŒ…å«è¯¦ç»†çš„æ­¥éª¤è¯´æ˜ã€æ•…éšœæ’æŸ¥ã€å®‰å…¨æœ€ä½³å®è·µç­‰
   - **ä¸»è¦æ–‡æ¡£ï¼Œè¯·ä¼˜å…ˆé˜…è¯»**

2. **docs/GCP_QUICK_START.md**
   - å¿«é€Ÿå¼€å§‹æŒ‡å—
   - 5åˆ†é’Ÿå¿«é€Ÿéƒ¨ç½²æµç¨‹
   - å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥è¡¨

3. **docs/GCP_DEPLOYMENT_SUMMARY.md**ï¼ˆæœ¬æ–‡ä»¶ï¼‰
   - éƒ¨ç½²æ–‡ä»¶æ€»ç»“

### éƒ¨ç½²è„šæœ¬

4. **scripts/gcp/setup_gcp.sh**
   - è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬
   - å®‰è£…æ‰€æœ‰ä¾èµ–ã€é…ç½®ç¯å¢ƒã€åˆ›å»ºå¿…è¦ç›®å½•
   - **é¦–æ¬¡éƒ¨ç½²æ—¶è¿è¡Œæ­¤è„šæœ¬**

5. **scripts/gcp/create_systemd_service.sh**
   - åˆ›å»ºsystemdæœåŠ¡è„šæœ¬
   - é…ç½®è‡ªåŠ¨å¯åŠ¨å’Œåå°è¿è¡Œ
   - äº¤äº’å¼é…ç½®å‘å¯¼

6. **scripts/gcp/load_secrets.sh**
   - ä»GCP Secret ManageråŠ è½½APIå¯†é’¥
   - ç”±setup_gcp.shè‡ªåŠ¨åˆ›å»º
   - åœ¨systemdæœåŠ¡ä¸­ä½¿ç”¨

### ç®¡ç†è„šæœ¬

7. **scripts/gcp/manage.sh**
   - ä¾¿æ·çš„æœåŠ¡ç®¡ç†å·¥å…·
   - æä¾›status, start, stop, restart, logsç­‰å‘½ä»¤
   - **æ—¥å¸¸ç®¡ç†æ¨èä½¿ç”¨æ­¤è„šæœ¬**

8. **scripts/gcp/update_code.sh**
   - æ›´æ–°ä»£ç å¹¶é‡å¯æœåŠ¡
   - è‡ªåŠ¨æ£€æŸ¥ä¾èµ–æ›´æ–°
   - å¯é€‰è‡ªåŠ¨é‡å¯æœåŠ¡

9. **scripts/gcp/README.md**
   - GCPè„šæœ¬ç›®å½•è¯´æ˜æ–‡æ¡£
   - è„šæœ¬ä½¿ç”¨æ–¹æ³•å’Œç¤ºä¾‹

## ğŸš€ éƒ¨ç½²æµç¨‹æ¦‚è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. åˆ›å»ºGCPé¡¹ç›®å¹¶å¯ç”¨API            â”‚
â”‚     - Compute Engine API            â”‚
â”‚     - Secret Manager API            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. åˆ›å»ºVMå®ä¾‹                       â”‚
â”‚     - Ubuntu 22.04 LTS              â”‚
â”‚     - e2-medium (æ¨è)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. SSHè¿æ¥å¹¶è¿è¡Œéƒ¨ç½²è„šæœ¬           â”‚
â”‚     bash scripts/gcp/setup_gcp.sh   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. é…ç½®APIå¯†é’¥                      â”‚
â”‚     - GCP Secret Manager (æ¨è)     â”‚
â”‚     - æˆ–ç¯å¢ƒå˜é‡æ–‡ä»¶                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. æµ‹è¯•è¿è¡Œ (Dry Run)              â”‚
â”‚     bash scripts/gcp/manage.sh test â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. åˆ›å»ºsystemdæœåŠ¡                 â”‚
â”‚     bash scripts/gcp/               â”‚
â”‚       create_systemd_service.sh     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. å¯åŠ¨æœåŠ¡                         â”‚
â”‚     bash scripts/gcp/manage.sh startâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ å¿«é€Ÿå‘½ä»¤å‚è€ƒ

### åˆå§‹éƒ¨ç½²

```bash
# 1. SSHè¿æ¥
gcloud compute ssh taoquant-vm --zone=us-central1-a

# 2. å…‹éš†å¹¶éƒ¨ç½²
git clone https://github.com/metaTaoTao/taoquant.git
cd taoquant
bash scripts/gcp/setup_gcp.sh

# 3. é…ç½®å¯†é’¥ï¼ˆSecret Managerï¼‰
echo -n "KEY" | gcloud secrets create bitget-api-key --data-file=-
echo -n "SECRET" | gcloud secrets create bitget-api-secret --data-file=-
echo -n "PASSPHRASE" | gcloud secrets create bitget-passphrase --data-file=-

# 4. æµ‹è¯•
bash scripts/gcp/manage.sh test

# 5. åˆ›å»ºæœåŠ¡å¹¶å¯åŠ¨
bash scripts/gcp/create_systemd_service.sh
bash scripts/gcp/manage.sh start
```

### æ—¥å¸¸ç®¡ç†

```bash
# æŸ¥çœ‹çŠ¶æ€
bash scripts/gcp/manage.sh status

# æŸ¥çœ‹æ—¥å¿—
bash scripts/gcp/manage.sh logs

# é‡å¯æœåŠ¡
bash scripts/gcp/manage.sh restart

# æ›´æ–°ä»£ç 
bash scripts/gcp/manage.sh update

# åœæ­¢æœåŠ¡
bash scripts/gcp/manage.sh stop
```

## ğŸ“– æ–‡æ¡£é˜…è¯»é¡ºåº

1. **æ–°æ‰‹ç”¨æˆ·**ï¼š
   - å…ˆè¯»ï¼š`docs/GCP_QUICK_START.md`ï¼ˆå¿«é€Ÿå¼€å§‹ï¼‰
   - å†è¯»ï¼š`docs/gcp_deployment_guide.md`ï¼ˆè¯¦ç»†æŒ‡å—ï¼‰

2. **æœ‰ç»éªŒç”¨æˆ·**ï¼š
   - ç›´æ¥çœ‹ï¼š`scripts/gcp/README.md`ï¼ˆè„šæœ¬è¯´æ˜ï¼‰
   - å‚è€ƒï¼š`docs/GCP_QUICK_START.md`ï¼ˆå‘½ä»¤é€ŸæŸ¥ï¼‰

3. **é‡åˆ°é—®é¢˜**ï¼š
   - æŸ¥çœ‹ï¼š`docs/gcp_deployment_guide.md` çš„"æ•…éšœæ’æŸ¥"ç« èŠ‚

## ğŸ”’ å®‰å…¨é…ç½®æ£€æŸ¥æ¸…å•

éƒ¨ç½²å‰è¯·ç¡®è®¤ï¼š

- [ ] GCPé¡¹ç›®å·²åˆ›å»º
- [ ] Compute Engine APIå·²å¯ç”¨
- [ ] Secret Manager APIå·²å¯ç”¨ï¼ˆå¦‚æœä½¿ç”¨Secret Managerï¼‰
- [ ] APIå¯†é’¥å·²å‡†å¤‡å¥½
- [ ] é˜²ç«å¢™è§„åˆ™å·²é…ç½®ï¼ˆé™åˆ¶è®¿é—®ï¼‰
- [ ] é…ç½®æ–‡ä»¶å·²è°ƒæ•´ç­–ç•¥å‚æ•°
- [ ] Dry Runæµ‹è¯•å·²é€šè¿‡

## ğŸ“ é…ç½®æ–‡ä»¶è¯´æ˜

### ç­–ç•¥é…ç½®æ–‡ä»¶

- **config_bitget_live.json** - é»˜è®¤é…ç½®æ–‡ä»¶
- **config_live.json** - å®é™…ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ï¼ˆå¤åˆ¶å¹¶ä¿®æ”¹ï¼‰

ä¸»è¦é…ç½®é¡¹ï¼š
- `support/resistance` - æ”¯æ’‘/é˜»åŠ›ä½
- `grid_layers_buy/sell` - ä¹°å–ç½‘æ ¼å±‚æ•°
- `regime` - å¸‚åœºçŠ¶æ€
- `leverage` - æ æ†å€æ•°
- `execution.market_type` - å¸‚åœºç±»å‹ï¼ˆspot/swapï¼‰

### ç¯å¢ƒå˜é‡

ä½¿ç”¨`.env`æ–‡ä»¶æˆ–GCP Secret Managerå­˜å‚¨ï¼š
- `BITGET_API_KEY`
- `BITGET_API_SECRET`
- `BITGET_PASSPHRASE`
- `BITGET_SUBACCOUNT_UID` (å¯é€‰)

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### ä»£ç æ›´æ–°

```bash
bash scripts/gcp/update_code.sh
# è‡ªåŠ¨æ‹‰å–ä»£ç ã€æ›´æ–°ä¾èµ–ã€é‡å¯æœåŠ¡
```

### é…ç½®æ›´æ–°

```bash
# 1. ç¼–è¾‘é…ç½®æ–‡ä»¶
nano ~/taoquant/config_live.json

# 2. é‡å¯æœåŠ¡
bash scripts/gcp/manage.sh restart
```

### å¯†é’¥æ›´æ–°

å¦‚æœä½¿ç”¨Secret Managerï¼š

```bash
# åˆ›å»ºæ–°ç‰ˆæœ¬
echo -n "NEW_KEY" | gcloud secrets versions add bitget-api-key --data-file=-

# é‡å¯æœåŠ¡ä»¥åŠ è½½æ–°å¯†é’¥
bash scripts/gcp/manage.sh restart
```

## ğŸ’° æˆæœ¬ä¼°ç®—

**VMæˆæœ¬**ï¼ˆe2-medium, us-central1ï¼‰ï¼š
- çº¦ $30-40/æœˆï¼ˆæŒ‰éœ€ä»˜è´¹ï¼‰
- çº¦ $15-20/æœˆï¼ˆä½¿ç”¨é¢„ç•™å®ä¾‹ï¼‰

**å…¶ä»–æˆæœ¬**ï¼š
- Secret Manager: å…è´¹ï¼ˆæ¯æœˆå‰6ä¸ªsecretç‰ˆæœ¬ï¼‰
- ç½‘ç»œæµé‡: é€šå¸¸å¾ˆå°‘ï¼ˆ< $5/æœˆï¼‰
- å­˜å‚¨: 20GBæ ‡å‡†ç£ç›˜çº¦ $3/æœˆ

**æ€»è®¡**: çº¦ $20-50/æœˆ

## ğŸ“ æ”¯æŒèµ„æº

- **é¡¹ç›®ä»“åº“**: https://github.com/metaTaoTao/taoquant
- **GCPæ–‡æ¡£**: https://cloud.google.com/docs
- **Bitget API**: https://bitgetlimited.github.io/apidoc/zh/swap/

## âœ… éƒ¨ç½²å®Œæˆæ£€æŸ¥

éƒ¨ç½²å®Œæˆåï¼Œè¯·éªŒè¯ï¼š

1. âœ… æœåŠ¡çŠ¶æ€æ­£å¸¸ï¼š`bash scripts/gcp/manage.sh status`
2. âœ… æ—¥å¿—æ— é”™è¯¯ï¼š`bash scripts/gcp/manage.sh logs-tail`
3. âœ… è¿›ç¨‹åœ¨è¿è¡Œï¼š`ps aux | grep run_bitget_live`
4. âœ… ç­–ç•¥å‚æ•°æ­£ç¡®ï¼šæ£€æŸ¥config_live.json
5. âœ… APIè¿æ¥æ­£å¸¸ï¼šæŸ¥çœ‹æ—¥å¿—ä¸­çš„è¿æ¥ä¿¡æ¯

---

**éƒ¨ç½²æ„‰å¿«ï¼å¦‚æœ‰é—®é¢˜ï¼Œè¯·å‚è€ƒè¯¦ç»†æ–‡æ¡£æˆ–æäº¤Issueã€‚** ğŸš€

